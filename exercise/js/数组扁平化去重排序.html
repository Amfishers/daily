<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>数组扁平化去重排序</title>
</head>

<body>
    <script>
        // 题：
        // 已知如下数组：var arr = [ [1, 2, 2], [3, 4, 5, 5], [6, 7, 8, 9, [11, 12, [12, 13, [14] ] ] ], 10];
        // 编写一个程序将数组扁平化去并除其中重复部分数据，最终得到一个升序且不重复的数组

        function convert (arr) {
            if (!Array.isArray(arr)) throw new Error('arr must be Array!')

            return [...new Set(arr.flat(Infinity))].sort((a, b) => a - b)
        }

        var arr = [[1, 2, 2], [3, 4, 5, 5], [6, 7, 8, 9, [11, 12, [12, 13, [14]]]], 10]
        console.info(convert(arr))



        // 组合函数写法
        // 扁平化
        const flattenDeep = (array) => array.flat(Infinity)

        // 去重
        const unique = (array) => Array.from(new Set(array))

        // 排序
        const sort = (array) => array.sort((a, b) => a - b)

        // 函数组合
        const compose = (...fns) => (initValue) => fns.reduceRight((y, fn) => fn(y), initValue)

        // 组合后函数
        const flatten_unique_sort = compose(sort, unique, flattenDeep)

        // 测试
        var arr = [[1, 2, 2], [3, 4, 5, 5], [6, 7, 8, 9, [11, 12, [12, 13, [14]]]], 10]
        console.log(flatten_unique_sort(arr))
// [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]

    </script>
</body>

</html>